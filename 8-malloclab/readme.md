### mm-implict分析

1. 首先明确为2字对齐,即要为16字节的倍数.```chunksize```为2^12,即4MB.   
```chunksize```为```heap```扩展时默认长度
2. ```heap```整体框架,这与第三版课本上描述不同.   
```heap```初始化,即```mm_init()```时,是有一个8字节的```序言块```,和一个8字节的```结束块```,注意这两个块都是始终不会释放的.   
他们的作用是: 是一种消除```合并```时边界条件的技巧.     
heap结构如下:     
    
    | 序言块(8) | hdr....ftr | hdr....ftr | 结束块(8) |   
    | :----: | :----: |   :----: | :------: |     
    |  8/1   | 普通块 |  普通块 |  0/1 |    




# malloc lab
---------------------------
##  实验目的
- 虚拟内存知识,实现malloc,free,calloc,realloc等函数.
- 要求在内存利用率,吞吐量方面都尽可能做到最好.
- 根据上一个目标,进行评分,评分标准如下:  
  ```40%(util) + 60%(through)```    
  实际上是拿你的程序和```libc```中的```malloc```进行比较.
  
## 实验材料及准备
- 修改```mm.c```文件:  在[课程网站](http://www.cs.cmu.edu/afs/cs/academic/class/15213-f17/www/schedule.html)中,有两次习题课,其中```rec1```是给你了一个初步的```implicit```即隐式空闲链表实现的```malloc```,而```rec11b```是给了一个初步的```explicit```显式空闲链表实现的```malloc```.
- 采用的数据结构:   
    - 隐式空闲链表
    - 显式空闲链表
    - 分离的空闲链表
- ```find_fit```策略:  
    - ```first fit```
    - ```best fit```
    - ```ordered by addr fit```
- 合并分割和优化边界(只针对implicit-freelist)策略:   
    - 立即合并
    - 推迟合并
    - 优化边界
- 编写```mm_checkheap()```函数,用来检测我们的空闲链表是否正确

## 实验过程

### 概览
分两次习题课,为```rec11```和```rec11b```两次,其中```rec1```是给你了一个初步的```implicit```即隐式空闲链表实现的```malloc```,而```rec11b```是给了一个初步的```explicit```显式空闲链表实现的```malloc```.     
但两个```mm.c```都有错误,使用```gdb```进行调试可改正错误. 之后,我们去组合上述方案,直至调整至最佳!

### 实现步骤
- 首先明确为2字对齐,即```payload```的起始地址为16的倍数,整个块大小要为16字节的倍数.```chunksize```为2^12,即4MB.   ```chunksize```为```heap```扩展时默认长度.
- ```heap```结构:  
    ```heap```初始化,即```mm_init()```时,是有一个8字节的```序言块```,和一个8字节的```结束块```,注意这两个块都是始终不会释放的.   
    他们的作用是: 是一种消除```合并```时边界条件的技巧.     
    heap结构如下:     

      | 序言块(8) | hdr....ftr | hdr....ftr | 结束块(8) |   
      | :----: | :----: |   :----: | :------: |     
      |  8/1   | 普通块 |  普通块 |  0/1 |       

1. 隐式空闲链表
    1. 链表结构:      
        其中```header``` 和```footer```为头部和脚部,都为8字节:     
        ```xxxxxxx | 0 0 1/0``` 最后一位为```0或者1```

        | 序言块(8) | hdr....ftr | hdr....ftr | 结束块(8) |   
        | :----: | :----: |   :----: | :------: |     
        |  8/1   | 普通块 |  普通块 |  0/1 |       

    2. ```mm_checkheap()```函数     
    ```mm_checkheap()```函数有以下目的:   
        - ```heap level```: 
            - 检查```heap_listp```指针
            - 检查有没有序言块和结束块,即```prologue``` and ```epilogue```.
        - ```block_level```:
    3. ```find fit```策略:   
    默认使用```first fit``` 结果如下

